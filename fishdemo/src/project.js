window.__require=function t(e,o,i){function c(r,a){if(!o[r]){if(!e[r]){var s=r.split("/");if(s=s[s.length-1],!e[s]){var l="function"==typeof __require&&__require;if(!a&&l)return l(s,!0);if(n)return n(s,!0);throw new Error("Cannot find module '"+r+"'")}}var p=o[r]={exports:{}};e[r][0].call(p.exports,function(t){return c(e[r][1][t]||t)},p,p.exports,t,e,o,i)}return o[r].exports}for(var n="function"==typeof __require&&__require,r=0;r<i.length;r++)c(i[r]);return c}({Fish:[function(t,e,o){"use strict";cc._RF.push(e,"7ea24k6QO9J06HVgVphBOmN","Fish");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),c=this&&this.__decorate||function(t,e,o,i){var c,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var a=t.length-1;a>=0;a--)(c=t[a])&&(r=(n<3?c(r):n>3?c(e,o,r):c(e,o))||r);return n>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,r=n.ccclass,a=n.property,s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.label=null,e.text="hello",e._waterNode=null,e._runloopAction=null,e}return i(e,t),e.prototype.onLoad=function(){this._waterNode=this.node.parent,cc.systemEvent.on("FishJump",function(){this.node.stopAction(this._runloopAction);var t=cc.moveBy(.2,cc.v2(0,30)).easing(cc.easeCubicActionOut()),e=cc.moveBy(.1,cc.v2(0,-30)).easing(cc.easeCubicActionIn());this.node.runAction(cc.sequence(cc.delayTime(1*Math.random()),t,e,cc.callFunc(function(){this.refreshPosition()}.bind(this))))}.bind(this))},e.prototype.start=function(){this.refreshPosition()},e.prototype.refreshPosition=function(){var t=this.getRandomPosition(),e=cc.scaleTo(.3,this.node.x>t.x?1:-1,1),o=this.node.position.sub(t),i=this.getDegree(o),c=cc.rotateTo(.2,(this.node.x,t.x,i)),n=3*Math.random();this.node.runAction(cc.sequence(e,c,cc.moveTo(n+2,t).easing(cc.easeQuadraticActionOut()),cc.delayTime(n+1),cc.callFunc(function(){this.refreshPosition()}.bind(this))))},e.prototype.getRandomPosition=function(){var t=this._waterNode.convertToNodeSpaceAR(cc.v2(0));return cc.v2({x:t.x+Math.random()*(this._waterNode.width-80)+40,y:t.y+Math.random()*(this._waterNode.height-80)+40})},e.prototype.getDegree=function(t){var e=Math.atan(t.y/t.x)/Math.PI*180;return t.x>=0?t.y<0&&(e+=360):t.y,e},e.prototype.onDestroy=function(){this.node.stopAction(this._runloopAction),cc.systemEvent.off("FishJump")},c([a(cc.Label)],e.prototype,"label",void 0),c([a],e.prototype,"text",void 0),e=c([r],e)}(cc.Component);o.default=s,cc._RF.pop()},{}],Helloworld:[function(t,e,o){"use strict";cc._RF.push(e,"e1b90/rohdEk4SdmmEZANaD","Helloworld");var i=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),c=this&&this.__decorate||function(t,e,o,i){var c,n=arguments.length,r=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,o,i);else for(var a=t.length-1;a>=0;a--)(c=t[a])&&(r=(n<3?c(r):n>3?c(e,o,r):c(e,o))||r);return n>3&&r&&Object.defineProperty(e,o,r),r};Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,r=n.ccclass,a=n.property,s=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.numberOfTopBall=20,e.gameBox=null,e.topBallPrefab=null,e.bottomBallPrefab=null,e.water=null,e.fishPrefab=null,e.fishAtlas=null,e.hitAudio=null,e.destroyAudio=null,e._isInitComplete=!1,e._topBallList=[],e._canvasSize=null,e._bottomBallList=[],e}return i(e,t),e.prototype.onLoad=function(){cc.director.getPhysicsManager().enabled=!0,cc.director.getPhysicsManager().gravity=cc.v2(0,-640),this._canvasSize=cc.view.getCanvasSize(),cc.log(this._canvasSize),this.gameBox.on(cc.Node.EventType.TOUCH_START,function(t){var e=this.gameBox.convertTouchToNodeSpaceAR(t);cc.log(t.touch),cc.log(e)}.bind(this))},e.prototype.start=function(){this.generateTopBalls(),this.generateFishes()},e.prototype.generateTopBalls=function(){var t=setInterval(function(){var e=Math.ceil(18*Math.random()),o=this.gameBox.convertToNodeSpaceAR(cc.v2(0)),i=cc.v2({x:o.x+Math.floor(Math.random()*(this._canvasSize.width/2-60))+30,y:this.gameBox.height/2}),c=cc.instantiate(this.topBallPrefab);c.getChildByName("TagLabel").getComponent(cc.Label).string=e+"",6!==e&&9!==e||(c.getChildByName("BottomLine").active=!0),this.gameBox.addChild(c),c.setPosition(i),cc.audioEngine.play(this.hitAudio,!1,1),this._topBallList.push(c),this._topBallList.length>=20&&(clearInterval(t),this.addKeyboardListener())}.bind(this),300)},e.prototype.generateFishes=function(){this.fishAtlas.getSpriteFrames().forEach(function(t){var e=cc.instantiate(this.fishPrefab);e.getComponent(cc.Sprite).spriteFrame=t,this.water.addChild(e)}.bind(this))},e.prototype.addKeyboardListener=function(){cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP,this.onInput,this)},e.prototype.onInput=function(t){if(t.keyCode>=cc.macro.KEY[0]&&t.keyCode<=cc.macro.KEY[9]){var e=9-(cc.macro.KEY[9]-t.keyCode);this.pushBottomBall(e)}t.keyCode===cc.macro.KEY.escape&&this.removeBottomBall()},e.prototype.pushBottomBall=function(t){var e=this;if(!(this._bottomBallList.length>=2)){var o=this.getBottomBallPosition(this._bottomBallList.length),i=cc.instantiate(this.bottomBallPrefab);i.getChildByName("TagLabel").getComponent(cc.Label).string=t+"",i.opacity=0,this.gameBox.addChild(i);var c=this.gameBox.convertToNodeSpaceAR(cc.v2(0));if(i.setPosition(cc.v2({x:c.x+this.gameBox.width/2,y:c.y})),i.runAction(cc.spawn(cc.fadeIn(.3),cc.moveTo(.5,o))),cc.audioEngine.play(this.hitAudio,!1,1),this._bottomBallList.push(i),this._bottomBallList.length>=2)for(var n=this._bottomBallList.map(function(t){return+t.getChildByName("TagLabel").getComponent(cc.Label).string}).reduce(function(t,e,o,i){return t+e}),r=0;r<this._topBallList.length;r++){var a=this._topBallList[r];if(a.getChildByName("TagLabel").getComponent(cc.Label).string===n+"")return a.runAction(cc.sequence(cc.scaleTo(.2,.8),cc.spawn(cc.scaleTo(.1,1.3),cc.fadeOut(.1)),cc.callFunc(function(t){t.removeFromParent(),cc.audioEngine.play(e.destroyAudio,!1,1),cc.systemEvent.emit("FishJump")},this,a))),void this._topBallList.splice(r,1)}cc.log(this._bottomBallList)}},e.prototype.removeBottomBall=function(){var t=this._bottomBallList.length;if(!(t<=0)){var e=this._bottomBallList[t-1];this._bottomBallList.splice(t-1,1);var o=this.gameBox.convertToNodeSpaceAR(cc.v2(0));e.runAction(cc.sequence(cc.spawn(cc.fadeOut(.3),cc.moveTo(.5,cc.v2(o.x+this.gameBox.width/2,o.y))),cc.callFunc(function(t){t.removeFromParent()},this,e))),cc.log(this._bottomBallList)}},e.prototype.getBottomBallPosition=function(t){var e=this.gameBox.convertToNodeSpaceAR(cc.v2(0)),o=cc.v2(0),i=Math.random()*(this.gameBox.width/2-130)+65,c=Math.random()*(this.gameBox.height/4-130)+this.gameBox.height/4;return 0===t?o=cc.v2({x:e.x+i,y:e.y+c}):1===t&&(o=cc.v2({x:e.x+this.gameBox.width/2+i,y:e.y+c})),o},e.prototype.onDestroy=function(){cc.systemEvent.off(cc.SystemEvent.EventType.KEY_UP,this.onInput,this)},c([a({type:cc.Integer,displayName:"\u6389\u843d\u7403\u7684\u6570\u91cf"})],e.prototype,"numberOfTopBall",void 0),c([a(cc.Node)],e.prototype,"gameBox",void 0),c([a({type:cc.Prefab,displayName:"\u9c7c\u5858\u4e0a\u9762\u7403\u7684Prefab"})],e.prototype,"topBallPrefab",void 0),c([a({type:cc.Prefab,displayName:"\u9c7c\u5858\u91cc\u9762\u7403\u7684Prefab"})],e.prototype,"bottomBallPrefab",void 0),c([a({type:cc.Node,displayName:"\u9c7c\u5858Node"})],e.prototype,"water",void 0),c([a({type:cc.Prefab,displayName:"\u9c7c\u7684Prefab"})],e.prototype,"fishPrefab",void 0),c([a({type:cc.SpriteAtlas,displayName:"\u9c7c\u7684\u8d44\u6e90\u56fe\u7247"})],e.prototype,"fishAtlas",void 0),c([a({type:cc.AudioClip,displayName:"\u53d1\u5c04BottomBall\u7684\u58f0\u97f3"})],e.prototype,"hitAudio",void 0),c([a({type:cc.AudioClip,displayName:"\u6d88\u9664TopBall\u7684\u58f0\u97f3"})],e.prototype,"destroyAudio",void 0),e=c([r],e)}(cc.Component);o.default=s,cc._RF.pop()},{}]},{},["Fish","Helloworld"]);